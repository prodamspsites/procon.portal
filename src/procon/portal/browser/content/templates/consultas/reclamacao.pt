<!-- <tal:dados tal:define="reclamacoes view/buscaReclamacao" tal:repeat="reclamacao reclamacoes">
  <tal:inputs tal:content="structure python:reclamacao[0]">
  <tal:inputs tal:content="structure python:reclamacao[1]">
  <tal:inputs tal:content="structure python:reclamacao[2]">
  <tal:inputs tal:content="structure python:reclamacao[3]">
  <tal:inputs tal:content="structure python:reclamacao[4]">
</tal:dados> -->



<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">
<body>
  <div id="content-core" metal:fill-slot="main">
  <span class="currentUser" tal:content="user/getUserName" />
  <!--RECLAMACOES-->
  <div class="wrapAdmin">
    <div class="divReclamacoes">
      <h1>Reclamações recebidas</h1>
      <!-- <span class="total">Total: <span tal:define="perguntas view/buscarPerguntaResposta;" tal:replace="python:perguntas['total']"></span></span> -->

      <div class="filtrarPor"><strong>Filtrar por:</strong>
      <form tal:attributes="action string:${context/portal_url}/buscar_reclamacoes" method="GET" name="filtro">
        <select name="coluna" class="selectFilter">
          <option value="-11">Data</option>
          <option value="-6">Prioridade</option>
          <option value="-10">Protocolo</option>
          <option value="-7">Tipo de cadastro</option>
          <option value="-8">Nome</option>
          <option value="-9">SINDEC</option>
          <option value="-5">FA</option>
          <option value="-4">Status</option>
          <option value="-1">Data de atualização</option>
          <option value="0">CPF/CNPJ do consumidor</option>
          <option value="-2">CPF/CNPJ do operador</option>
        <select>
        <input type="text"  name="filtro" placeholder="Digite um valor para filtrar" class="inputFilter"/>
        <input type="submit" value="FILTRAR" class="btnFiltrar" />
      </form>
    </div>
      <div class="tableReclamacoes">
      <table id="table_id_reclamacoes" class="display" width="133%" style='border:0px'>
          <thead>
            <tr>
              <th width="1%" style="display:none">
                <span>.</span>
              </th>
              <th width="12%">
                <span>Data</span>
              </th>
              <th width="12%">
                <span>Prioridade</span>
              </th>
              <th width="18%">
                <span>Tipo de cadastro</span>
              </th>
              <th width="13%">
                <span>Protocolo</span>
              </th>
              <th width="20%">
                <span>Consumidor</span>
              </th>
              <th width="1%" style="display:none">
                <span>.</span>
              </th>
              <th width="15%">
                <span>SINDEC</span>
              </th>
              <th width="22%">
                <span>FA</span>
              </th>
              <th width="10%">
                <span>Status</span>
              </th>
              <th width="10%">
                <span>Data Atualização</span>
              </th>
              <th width="10%">
                <span>Operador</span>
              </th>
            </tr>
          </thead>
          <tbody style="border:0px">
            <tr tal:condition="dados" tal:define="dados view/buscaReclamacao" tal:repeat="pergunta dados">
              <td class="reclamacao_buscar _id"
                  tal:content="python:dados[int(repeat.pergunta.number) -1][-11]"
                  tal:attributes="rel python:int(repeat.pergunta.number) -1;
                                  class python:'categoria reclamacao_buscar';">07/06/2016</td>

              <td tal:content="python:dados[int(repeat.pergunta.number) -1][-6]"
                  tal:attributes="rel python:int(repeat.pergunta.number) -1;
                                  class python:'categoria reclamacao_buscar';">
              </td>
              <td tal:attributes="class python:'categoria reclamacao_buscar';
                                  rel python:int(repeat.pergunta.number) -1"
                  tal:content="python:dados[int(repeat.pergunta.number) -1][-7]">Cadastro</td>
              <td tal:attributes="class python:'pergunta reclamacao_buscar';
                                  rel python:int(repeat.pergunta.number) -1"
                  tal:content="python:dados[int(repeat.pergunta.number) -1][-10]">00998821888</td>
              <td tal:attributes="class python:'usuario reclamacao_buscar';
                                  rel python:int(repeat.pergunta.number) -1"
                  tal:content="python:dados[int(repeat.pergunta.number) -1][-8]">Admin</td>
              <td tal:content="python:dados[int(repeat.pergunta.number) -1][-9]"></td>
              <td tal:define="FA python:dados[int(repeat.pergunta.number) -1][-5];
                              FA python:FA and FA or '';"
                  tal:content="FA"
                  tal:attributes="rel python:int(repeat.pergunta.number) -1"></td>


              <td>
                <div class="respostaConsumidor">
                  <select id="reclamacao_status"
                          tal:attributes="rel python:dados[int(repeat.pergunta.number) -1][-10];
                                          disabled string:true">
                      <tal:block tal:define="retorno
                                             python:dados[int(repeat.pergunta.number) -1][-4]"
                                 tal:repeat="record view/reclamacaoStatus">
                          <option tal:condition="python: record != retorno"
                                  tal:attributes="value record"
                                  tal:content="record"></option>
                          <option tal:condition="python: record == retorno"
                                  tal:attributes="value record"
                                  tal:content="record"
                                  selected="selected">
                          </option>
                      </tal:block>
                  </select>

              </td>
              <td tal:define="atualizacao python:dados[int(repeat.pergunta.number) -1][-1];
                              atualizacao python:atualizacao and atualizacao or '';"
                  tal:content="atualizacao"></td>
              <td tal:content="python:dados[int(repeat.pergunta.number) -1][-2]"></td>
              <td class="td_interno" style="display:none"></td>
            </tr>
          </tbody>
          <!-- bower:js -->
          <!-- endbower -->
      </table>
      </div>

      <tal:result tal:condition="perguntas" tal:define="perguntas view/buscaReclamacao">
      <div class="paginationReclamacoes">
      </div>
      </tal:result>

<script  type="text/javascript" >

    

//vars globais

    var numero = 0;

    var redirect = '';

    var objsClick = document.getElementsByClassName('reclamacao_buscar');

    var eventType = window.attachEvent ? 'onclick' : 'click';



    //loop pelos tds 

    for(var i=0; i<objsClick.length; i++){



         //adiciona clicks   

         if(window.addEventListener){



            var obj=objsClick[i];

            

            obj.addEventListener(eventType ,function(){

               // console.log(this.getAttribute("rel"))

                numero = this.getAttribute('rel');

                redirect = portal_url  + '/@@buscar_reclamacoes_detalhe';

                redirectPost(redirect, {detailNumber: numero});

            })





         }else{

            

            // se IE <9

            var obj=objsClick[i];

            

            obj.attachEvent(eventType ,function(){

                numero = this.getAttribute('rel');

                redirect = '/@@buscar_reclamacoes_detalhe';

                redirectPost(redirect, {detailNumber: numero});

            })

         }

        



    }







    function redirectPost(location, args){



        var oArg = args;

        var chave;

        var inputs = '';

        //cria os inputs

        for (chave in oArg ){

            inputs+='<input type="hidden" name="'+chave+'" value="'+oArg[chave]+'">';

        } 



        //cria o form

        var strForm = '<form action="'+location+'" method="POST" id="'+(chave + oArg[chave])+'">'+inputs+'</form>';



        var child = document.createElement('div');

        child.innerHTML = strForm;



        //adiciona ao body

        document.body.appendChild(child);



        var form = document.getElementById((chave + oArg[chave]));

            form.submit();

    }





/*

$(document).on('click',"td.reclamacao_buscar",function(){

    numero = $(this).attr('rel')

    redirect = portal_url + '/@@buscar_reclamacoes_detalhe';

$.extend(

{

    redirectPost: function(location, args)

    {

        var form = '';

        $.each( args, function( key, value ) {

            form += '<input type="hidden" name="'+key+'" value="'+value+'">';

        });

        $('<form action="'+location+'" method="POST">'+form+'</form>').appendTo('body').submit();

    }

});

$.redirectPost(redirect, {detailNumber: numero});

});



*/
</script>

    </div>
  </div>

  </div>

</body>
</html>
